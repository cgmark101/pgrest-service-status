<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Service Status</title>
</head>
<body>
    <h1>Service Status</h1>
    <table>
        <tr>
            <th>Service Name</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
        <tr>
            <td>postgrest.admision.service</td>
            <td><span id="status-admision">Loading...</span></td>
            <td>
                <button onclick="stopService('admision')">Stop</button>
                <button onclick="restartService('admision')">Restart</button>
                <button onclick="startService('admision')">Start</button>
            </td>
        </tr>
        <tr>
            <td>postgrest.cc2000.service</td>
            <td><span id="status-cc2000">Loading...</span></td>
            <td>
                <button onclick="stopService('cc2000')">Stop</button>
                <button onclick="restartService('cc2000')">Restart</button>
                <button onclick="startService('cc2000')">Start</button>
            </td>
        </tr>
        <tr>
            <td>postgrest.comedor.service</td>
            <td><span id="status-comedor">Loading...</span></td>
            <td>
                <button onclick="stopService('comedor')">Stop</button>
                <button onclick="restartService('comedor')">Restart</button>
                <button onclick="startService('comedor')">Start</button>
            </td>
        </tr>
        <!-- add more services here -->
    </table>
    <script>
        function updateStatus(serviceName, elementId) {
            fetch(`/status/${serviceName}`)
            .then(response => response.json())
            .then(data => {
                const statusSpan = document.getElementById(elementId);
                if (data.status.includes("active (running)")) {
                    statusSpan.innerText = "Running";
                    statusSpan.style.color = "green";
                } else if (data.status.includes("inactive (dead)")) {
                    statusSpan.innerText = "Stopped";
                    statusSpan.style.color = "red";
                } else {
                    statusSpan.innerText = "Error";
                    statusSpan.style.color = "orange";
                }
            })
            .catch(error => {
                const statusSpan = document.getElementById(elementId);
                statusSpan.innerText = "Error";
                statusSpan.style.color = "orange";
            });
        }

        function stopService(serviceName) {
            fetch(`/action`)
            .then(() => {
                updateStatus(serviceName, `status-${serviceName}`);
            })
            .catch(error => {
                console.log(error);
            });
        }

        function restartService(serviceName) {
            fetch(`/restart/${serviceName}`)
            .then(() => {
                updateStatus(serviceName, `status-${serviceName}`);
            })
            .catch(error => {
                console.log(error);
            });
        }

        function startService(serviceName) {
            fetch(`/start/${serviceName}`)
            .then(() => {
                updateStatus(serviceName, `status-${serviceName}`);
            })
            .catch(error => {
                console.log(error);
            });
        }

        updateStatus("admision", "status-admision");
        updateStatus("cc2000", "status-cc2000");
        updateStatus("comedor", "status-comedor");
        <!-- add more services here -->
    </script>
</body>
</html>
